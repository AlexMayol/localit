!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).localit={})}(this,(function(e){"use strict";let t="";let s=localStorage;const n=new class{constructor(){this.listeners={},this.on.bind(this),this.emit.bind(this)}on(e,t){return this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t),this}emit(e,...t){if(!this.listeners[e])return null;for(let s=0;s<this.listeners[e].length;s++){this.listeners[e][s].call(this,...t)}}clear(){Object.keys(this.listeners).map((e=>{this.emit(e,null)}))}},i=e=>`${t}${e}`,o=e=>`${i(e)}_expiration_date`,r={config({domain:e=null,type:n="localStorage"}){s="localStorage"===n?localStorage:sessionStorage,t=e?`${e}_`:""},set(e,t,r){if(!e)return console.error("Localit: provide a key to store the value");"object"==typeof t&&(t=JSON.stringify(t)),s.setItem(i(e),t),r&&((e,t)=>{const n=new Date,i={h:e=>n.setHours(n.getHours()+e),d:e=>n.setDate(n.getDate()+e),m:e=>n.setMinutes(n.getMinutes()+e),s:e=>n.setSeconds(n.getSeconds()+e)},r=Object.keys(i),l=t[t.length-1],a=Number(t.replace(l,""));if(t.length<2||!r.some((e=>l===e))||isNaN(a))return console.warn("Localit: provide a valid expiration time format (e.g. '20h', '160s', '15d'). Your expiration date hasn't been saved.");s.setItem(o(e),JSON.stringify(i[l](a)))})(e,r),n.emit(i(e),t)},get(e){if((e=>null!==s.getItem(o(e)))(e)&&(e=>{const t=JSON.parse(s.getItem(o(e)));return new Date>new Date(t)})(e))return this.remove(e),null;try{return JSON.parse(s.getItem(i(e)))}catch(t){return s.getItem(i(e))}},remove(e){s.removeItem(i(e)),s.removeItem(o(e)),n.emit(i(e),null)},getAndRemove(e){const t=this.get(e);return this.remove(e),n.emit(i(e),null),t},setDomain(e){t=`${e}_`},clearDomain(e=t){for(const t of Object.keys(s))t.includes(`${e}_`)&&(s.removeItem(t),n.emit(t,null))},bust(){s.clear(),n.clear()},onChange(e,t){n.on(e,t)}};e.localit=r,Object.defineProperty(e,"__esModule",{value:!0})}));
